# 2023년 3월 2일 TIL

## [배운 내용]

**MVC, MVVM**


<img width="675" alt="스크린샷 2023-02-07 오전 12 52 09" src="https://user-images.githubusercontent.com/104732020/222428245-d68fde84-f24b-4fae-9787-ce3f9d35ddf7.png">

위의 그림은 애플 문서에서 가이드하던 MVC구조이다. 

MVC는 그림처럼 Model View Controller의 약자이다.  

Model은 어떤 데이터들

View는 실제 사용자에게 보여지는 뷰들

그 사이에 View Controller가 컨트롤 역할을 하면서 모델과 뷰사이에 상호작용을 한다.

애플이 가이드해준대로 MVC패턴을 잘 쓰면은 상관이 없지만 실제로 UIkit에서 View나 ViewController를 사용해보면 View나  ViewController가 상당히 엄청 가깝다. 

세가지 덩어리가 각각 있는 것처럼 보여지지만 뷰와 뷰컨트롤러가 엄청 붙어있다.

![Untitled](https://user-images.githubusercontent.com/104732020/222428658-d05c04aa-bae9-4f82-ae74-655e7c0f8415.png)

그러다보니 위 그림과 같이 표현되는게 좀 더 현실모습을 담고 있다.

이러다보니 View Controller에 많은 로직이 존재하게 되는 경우가 있다.

예를 들어

- 프레젠테이션 로직
- 비즈니스 로직
- 데이터 접근 로직
- 등등

이러한 뷰컨트롤러가 점점 비대해지는데 .. 애플이 시키는대로 했지만 구조적으로 뷰컨트롤러가 커지는 구조를 

가졌으니깐 사람들이 놀리는 용어로 **M**assive **V**iew**C**ontroller 생김<br><br><br><br>

## 위와 같은 이유로 발생하는 문제

- view Controller가 너무 많은 책임을 지고 있다.

예를 들면 학급에 있는 반장이 여러가지 역할을 하게 되면 힘들어지는 것처럼  

뷰컨트롤러가 너무 많은 역할을 하게 되면 힘들어진다. ( 나중에는 감당할 수 없어짐.. 개발자들도 ) 그러다보니

유지보수가 어려운 경우가 생긴다.

- 모델(데이터)를 직접 접근하면서 수정하다보니, 버그에 취약하게 됨.

결국 비대해진 뷰컨트롤러는 마치 여러가지 문제를 담고있는 **폭탄**과 같다.<br><br><br><br>

## 🤔그래서 문제를 해결하기 위해서

ViewController를 View레이어로 이해하자 그러면 View레이어에서는 어떤 일을 해야하냐면

- 데이터를 뷰에 표시한다
- 사용자 인터렉션을 받아서 처리해주는 녀석에게 던져준다.

(그동안 뷰컨트롤러가 많은 일을 했다…)

View 레이어에 알맞은 형태로 Model을 가공해서 전달하자.

- 즉, ViewModel로 제공하자

예를 들어 Model에 Data 타입이 있다면 화면에 보여줄때는 String타입으로 보여줘야 하니 그런걸로 변환되어  

있는 형태처럼 이러한 것을 ViewModel의 타입을 통해서 변환시켜주면 된다. 

그리고 ViewModel에는 정말 View에 필요한 ViewModel들을 만들어주기도 하고 각종 모델들을 뷰모델을 통해서  뷰에 꽂아주는 형태로 만들어주는 사이에 필요한 각종 Controller 및 Manager가 있을 수 있다.

이러한 것들은 View 레이어가 모르게 해야한다. 그래서 View는 ViewModel이 떠먹여주는 것만 먹는 것처럼..

View가 “네트워크 이렇게 해야하는거 아니야?”, “DB접근해서 해야되는거 아니야?”라는 능동적인 행동을 최대한

자제하게 한다. 왜냐하면 다른 객체들을 만들어서 걔네에게 책임을 줄거이기 때문에 정말 View는 바보로 만들어야 한다.<br><br><br><br>

### 결론적으로 ViewModel을 만들자 → 기존에 문제해결

MVVM의 약자는

Model - View - ViewModel 

![Untitled (1)](https://user-images.githubusercontent.com/104732020/222428862-e8392fe1-ef6a-4247-a928-ff5a09becdfa.png)

View레이어는 Model과 직접 통신하지 않는다.

View Controller는 ViewModel을 들고 있고

View Model은 Model을 들고 있다.<br><br><br><br>

## View Model은 어떤 역할을 하나?

### 1. Data → Output

- Model(Data) 를 가지고 있고,
    - View 에 적용할수 있도록 가공되어 있음
    - 데이터를 꽂아주는 역할을 하고 있다

### 2. User Action → Input

- User Action 에 대한 처리를 담당함
    - 실제 액션에 대해서는 View 가 알려줌
    
    - 다만 액션으로 수행되어야 하는 비즈니스 로직을 처리함

View에다가 떠먹여줘야 하니깐 View에 어떤 모델들을 바로 꽂을 수 있도록 가공하는 작업도 하고 있으며,

Data가 업데이트되면은 변경된 Data에 따라서 View에다가 변경된 Data를 가공시켜서 View에 꽂아버린다.

사용자들이 View에다가 익터랙션으로 버튼을 클릭하게 되면 “클릭이 되었어요”라고 View Model에게 알려준다.

그러면 View Model은 클릭에 필요한 비즈니스 로직을 필요한 녀석을 찾아서 요청하도록 할게 일단은 인터랙션이 있으면 알려줘 라는 역할을 한다.

그래서 하나의 코드객체가 너무 많은 책임을 가지게 되는 것보다 이 객체는 하나의 책임을 질 수 있게끔 특정 패턴을 제안한 것을 많은 개발자들이 채택한 것이 바로 MVVM이다. <br><br><br><br>

# 코드를 잘 짜고 유지보수 가능하게끔 미래의 코드를 보는 사람을 위해서 배려하는 마음으로 디자인패턴을 공부하는 것이다.

